<div class="quiz-play" *ngIf="quiz; else notFound" appChangeBackground>
  <div class="container">
    <h1 class="text-center text-3xl opacity-0">{{ quiz.title }}</h1>

    <!-- Анимация для вопроса -->
    <div
      class="quiz-play-quistion bg-gradient-base-180 flex flex-col items-center justify-center relative quiz-container pt-5"
      [@questionFadeIn]="currentQuestionIndex"
      *ngIf="currentQuestionIndex < questions.length; else finished"
    >
      <div class="timer-box">
        <div
          class="radial-progress bg-base-100"
          [style.--value]="progress"
          role="progressbar"
          [ngClass]="{
            'text-error': currentTime < 5,
            'text-accent': currentTime >= 5 && currentTime < 10,
            'text-primary': currentTime >= 10
          }"
        >
          <span class="countdown font-mono text-3xl">
            <span [style.--value]="currentTime"></span>
          </span>
        </div>
      </div>

      <div class="quistion-text w-full">
        <img
          class="w-full h-full object-cover"
          *ngIf="questions[currentQuestionIndex].image"
          [src]="questions[currentQuestionIndex].image"
          alt="Question image"
        />
        <h3 class="text-2xl my-4 px-2">
          {{ questions[currentQuestionIndex].text }}
        </h3>
      </div>
    </div>

    <ul
      class="quiz-play-answers-list quiz-container"
      [@answersFadeIn]="currentQuestionIndex"
      *ngIf="isAnswerVisible && currentQuestionIndex < questions.length"
    >
      <li
        *ngFor="let answer of questions[currentQuestionIndex]?.answers"
        (click)="onAnswerSelect(answer)"
        appRandomBackground
        class="quiz-play-answers-item bg-gradient-base-0 flex items-center justify-center cursor-pointer text-center"
      >
        {{ answer.text }}
      </li>
    </ul>
  </div>
</div>

<ng-template #finished>
  <app-quiz-finished
    [quiz]="quiz"
    (reset)="resetProgress()"
    (getResults)="getResults()"
  ></app-quiz-finished>
</ng-template>

<ng-template #notFound>
  <div class="loading-container text-center h-screen">
    <span class="loading loading-ring text-accent loading-lg"></span>
    <span class="loading loading-ring text-regular loading-md"></span>
  </div>
</ng-template>
