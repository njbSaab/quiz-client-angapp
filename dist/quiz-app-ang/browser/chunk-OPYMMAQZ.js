import{c as N,d as U,f as v,g as R,h as $,i as B,m as Y}from"./chunk-B63SKJIE.js";import{a as G}from"./chunk-DWCYGE72.js";import{$ as u,F as w,Fa as D,G as a,H as m,Ha as T,M as d,N as s,Q as n,R as o,S as l,T as q,U as y,X as g,Y as I,Z as S,_ as M,aa as p,d as f,da as b,ea as _,ga as O,ha as P,ia as E,ka as F,p as z,ra as k,s as h,sa as Q,t as x,ta as L,ua as j,va as A,y as C}from"./chunk-LQ3NOQTV.js";var J=t=>["/quiz",t],K=()=>[1,2,3,4,5],W=t=>({filled:t});function X(t,c){if(t&1&&l(0,"img",18),t&2){let e=g().$implicit;I("alt",e.title),s("src",e.previewImage,w)}}function ee(t,c){if(t&1&&l(0,"input",19),t&2){let e=c.index,i=g().$implicit;S("name","rating-",i.id,""),s("ngClass",_(3,W,e<(i.rate||0)))}}function te(t,c){if(t&1&&(n(0,"div",6)(1,"figure"),d(2,X,1,2,"img",7),o(),n(3,"div",8)(4,"div",9)(5,"span",10),u(6),O(7,"date"),o(),n(8,"div",11),d(9,ee,1,5,"input",12),o()(),n(10,"h2",13),u(11),o(),n(12,"p"),u(13),o()(),n(14,"div",14)(15,"button",15)(16,"span"),C(),n(17,"svg",16),l(18,"path",17),o()(),u(19," \u0418\u0433\u0440\u0430\u0442\u044C \u0441\u0435\u0439\u0447\u0430\u0441! "),o()()()),t&2){let e=c.$implicit;s("routerLink",_(8,J,e.id)),a(2),s("ngIf",e.previewImage),a(4),p(P(7,6,e.createdAt)),a(3),s("ngForOf",b(10,K)),a(2),p(e.title),a(2),p(e.description)}}function ie(t,c){if(t&1&&(q(0),n(1,"div",3)(2,"div",4),d(3,te,20,11,"div",5),o()(),y()),t&2){let e=g();a(2),s("@listAnimation",void 0),a(),s("ngForOf",e.quizzes)}}function ne(t,c){t&1&&(n(0,"div",20),l(1,"span",21)(2,"span",22),o())}var V=(()=>{class t{quizService;userService;cdr;quizzes=[];constructor(e,i,r){this.quizService=e,this.userService=i,this.cdr=r}ngOnInit(){this.loadQuizzes(),this.saveUserSession()}loadQuizzes(){this.quizService.getQuizzes().subscribe({next:e=>{console.log("\u041F\u043E\u043B\u0443\u0447\u0435\u043D\u043D\u044B\u0435 \u0434\u0430\u043D\u043D\u044B\u0435 \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430:",e),this.quizzes=e.filter(i=>i.isActive),this.cdr.markForCheck()},error:e=>{console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u043A\u0432\u0438\u0437\u043E\u0432:",e),this.cdr.markForCheck()}})}saveUserSession(){return f(this,null,function*(){let e={userAgent:navigator.userAgent,language:navigator.language,screen:{width:window.screen.width,height:window.screen.height},timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,cookiesEnabled:navigator.cookieEnabled,platform:navigator.platform,referrer:document.referrer,ipAddress:yield this.getIpAddress(),geolocation:void 0};navigator.geolocation?navigator.geolocation.getCurrentPosition(i=>{e.geolocation={latitude:i.coords.latitude,longitude:i.coords.longitude},this.sendSessionData(e)},i=>{console.warn("\u0413\u0435\u043E\u043B\u043E\u043A\u0430\u0446\u0438\u044F \u043D\u0435 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0430:",i),this.sendSessionData(e)}):this.sendSessionData(e)})}getIpAddress(){return f(this,null,function*(){try{return(yield(yield fetch("https://api.ipify.org?format=json")).json()).ip}catch(e){console.warn("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u043F\u043E\u043B\u0443\u0447\u0438\u0442\u044C IP:",e);return}})}sendSessionData(e){let i={quizId:0,sessionId:this.userService.getSessionId(),currentQuestionIndex:0,correctAnswersCount:0,totalPoints:0,answers:[],browserInfo:e};this.userService.saveUserSession(i).subscribe({next:r=>{console.log("\u0421\u0435\u0441\u0441\u0438\u044F \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0430:",r),r.session?.sessionId&&localStorage.setItem("sessionId",r.session.sessionId)},error:r=>{console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0438\u044F \u0441\u0435\u0441\u0441\u0438\u0438:",r)}})}static \u0275fac=function(i){return new(i||t)(m(Y),m(G),m(F))};static \u0275cmp=h({type:t,selectors:[["app-quiz-list"]],decls:4,vars:2,consts:[["loading",""],[1,"quiz-list","h-space"],[4,"ngIf","ngIfElse"],[1,"container","bg-gradient-primary-0","rounded-box","py-5"],[1,"quiz-list-wrapper","grid","grid-cols-1","sm:grid-cols-2"],["class","card quiz-item bg-card-gradient",3,"routerLink",4,"ngFor","ngForOf"],[1,"card","quiz-item","bg-card-gradient",3,"routerLink"],[3,"src","alt",4,"ngIf"],[1,"card-body"],[1,"card-body-header","flex","justify-between","items-center"],[1,"text-sm","text-green-400"],[1,"rating"],["type","radio","class","mask mask-star text-accent bg-accent",3,"name","ngClass",4,"ngFor","ngForOf"],[1,"card-title"],[1,"card-actions","justify-end","card-footer"],[1,"btn","btn-accent","btn-card","text-base-200"],["xmlns","http://www.w3.org/2000/svg","width","32","height","32","viewBox","0 0 24 24",1,"h-10","w-10","fill-current"],["d","M8 5v14l11-7z"],[3,"src","alt"],["type","radio",1,"mask","mask-star","text-accent","bg-accent",3,"name","ngClass"],[1,"loading-container","text-center"],[1,"loading","loading-ring","text-accent","loading-lg"],[1,"loading","loading-ring","text-regular","loading-md"]],template:function(i,r){if(i&1&&(n(0,"div",1),d(1,ie,4,2,"ng-container",2)(2,ne,3,0,"ng-template",null,0,E),o()),i&2){let Z=M(3);a(),s("ngIf",r.quizzes==null?null:r.quizzes.length)("ngIfElse",Z)}},dependencies:[k,Q,L,D,j],styles:[".quiz-list[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{max-width:1440px;margin:0 auto;padding:40px 0}.quiz-list[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:hover{box-shadow:0 0 3em #fff;cursor:pointer;transition:.3s ease-in-out}.quiz-list[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:active{transform:scale(.98);transition:.1s ease-in-out}.quiz-list[_ngcontent-%COMP%]   .quiz-list-wrapper[_ngcontent-%COMP%]{gap:10px;max-width:800px;width:100%;margin:0 auto}.quiz-list[_ngcontent-%COMP%]   .quiz-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:contain;width:100%;height:300px}.quiz-list[_ngcontent-%COMP%]   .quiz-item[_ngcontent-%COMP%]{flex:33%}.quiz-list[_ngcontent-%COMP%]   .btn-card[_ngcontent-%COMP%]{width:100%;border-radius:0 0 15px 15px}.quiz-list[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:active:focus{transform:none}.quiz-list[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto;aspect-ratio:auto}"],data:{animation:[N("listAnimation",[R(":enter",[$(".quiz-item",[v({opacity:0,transform:"translateY(20px)"}),B(100,[U("500ms ease-out",v({opacity:1,transform:"translateY(0)"}))])])])])]}})}return t})();var oe=[{path:"",component:V}],fe=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=x({type:t});static \u0275inj=z({imports:[A,T.forChild(oe)]})}return t})();export{fe as a};
